type: specs.openrewrite.org/v1beta/recipe
name: ai.timefold.solver.migration.ToLatest
displayName: Upgrade to the latest Timefold Solver
description: 'Replace all your calls to deleted/deprecated types and methods of Timefold Solver with their proper alternatives.'
recipeList:
  - ai.timefold.solver.migration.FromOptaPlannerToTimefoldSolver
  - org.openrewrite.properties.ChangePropertyKey:
      oldPropertyKey: timefold.solver.solve-length
      newPropertyKey: timefold.solver.solve.duration
      fileMatcher: '**/application.properties'
  - org.openrewrite.properties.ChangePropertyKey:
      oldPropertyKey: quarkus.timefold.solver.solve-length
      newPropertyKey: quarkus.timefold.solver.solve.duration
      fileMatcher: '**/application.properties'
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.api.score.stream.ConstraintFactory from(Class)
      newMethodName: forEach
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.api.score.stream.ConstraintFactory fromUnfiltered(Class)
      newMethodName: forEachIncludingUnassigned
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.api.score.stream.ConstraintFactory forEachIncludingNullVars(Class)
      newMethodName: forEachIncludingUnassigned
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.api.score.stream.ConstraintFactory fromUniquePair(..)
      newMethodName: forEachUniquePair
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.api.score.stream.uni.UniConstraintStream ifExistsIncludingNullVars(...)
      newMethodName: ifExistsIncludingUnassigned
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.api.score.stream.uni.UniConstraintStream ifExistsOtherIncludingNullVars(...)
      newMethodName: ifExistsOtherIncludingUnassigned
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.api.score.stream.uni.UniConstraintStream ifNotExistsIncludingNullVars(...)
      newMethodName: ifNotExistsIncludingUnassigned
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.api.score.stream.uni.UniConstraintStream ifNotExistsOtherIncludingNullVars(...)
      newMethodName: ifNotExistsOtherIncludingUnassigned
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.api.score.stream.bi.BiConstraintStream ifExistsIncludingNullVars(...)
      newMethodName: ifExistsIncludingUnassigned
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.api.score.stream.bi.BiConstraintStream ifNotExistsIncludingNullVars(...)
      newMethodName: ifNotExistsIncludingUnassigned
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.api.score.stream.tri.TriConstraintStream ifExistsIncludingNullVars(...)
      newMethodName: ifExistsIncludingUnassigned
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.api.score.stream.tri.TriConstraintStream ifNotExistsIncludingNullVars(...)
      newMethodName: ifNotExistsIncludingUnassigned
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.api.score.stream.quad.QuadConstraintStream ifExistsIncludingNullVars(...)
      newMethodName: ifExistsIncludingUnassigned
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.api.score.stream.quad.QuadConstraintStream ifNotExistsIncludingNullVars(...)
      newMethodName: ifNotExistsIncludingUnassigned
  - org.openrewrite.java.ChangeAnnotationAttributeName:
      annotationType: ai.timefold.solver.core.api.domain.variable.PlanningVariable
      oldAttributeName: nullable
      newAttributeName: allowsUnassigned
  - ai.timefold.solver.migration.v8.ScoreManagerMethodsRecipe
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: ai.timefold.solver.core.api.score.ScoreManager
      newFullyQualifiedTypeName: ai.timefold.solver.core.api.solver.SolutionManager
      ignoreDefinition: true
  - ai.timefold.solver.migration.v8.ScoreGettersRecipe
  - ai.timefold.solver.migration.v8.ConstraintRefRecipe
  - ai.timefold.solver.migration.v8.SolverManagerBuilderRecipe
  - org.openrewrite.java.RemoveUnusedImports
  - ai.timefold.solver.migration.ChangeVersion
